---
import { allPlaylists, songs } from "@/lib/data";
import Layout from "../../layouts/Layout.astro";
import PlayListItemCard from "@/components/PlayListItemCard.astro";
import { MusicsTable } from "@/components/MusicTable";
import CardPlayButton from "@/components/CardPlayButton";

export const prerender = false;
const { id } = Astro.params;

const playlists = allPlaylists.find((playlist) => playlist.id === id);
const playListSongs = songs.filter(
	(song) => song.albumId === playlists?.albumId,
);
---

<Layout title="Spotify Clone">
	<div
		id="playlist-container"
		class="relative flex flex-col h-full bg-zinc-900 overflow-x-hidden bg-gradient-to-t from-50% from-zinc-900 via-zinc-900/80"
		transition:name=`playlist ${id} box`
	>
		<header class="flex gap-8 px-6 mt-12">
			<picture class="aspect-square w-52 h-52 rounded-md flex-none">
				<img
					src={playlists?.cover}
					alt={`Cover of ${playlists?.title}`}
					class="object-cover w-full h-full"
					transition:name=`playlist ${playlists?.id} image`
				/>
			</picture>
			<div class="flex flex-col justify-between">
				<h2 class="flex flex-1 items-end">Playlist</h2>
				<div>
					<h1 class="text-5xl font-bold block text-white">
						{playlists?.title}
						<span transition:name=`playlists ${playlists?.id} title`></span>
					</h1>
				</div>
				<div class="flex-1 flex items-end">
					<div class="text-sm text-gray-300 font-normal">
						<div transition:name=`playlists ${playlists?.id} artists`>
							<span>{playlists?.artists.join(", ")}</span>
						</div>
						<p class="mt-1">
							<span class="text-white">50 Canciones</span>, 3h aproximadamente
						</p>
					</div>
				</div>
			</div>
		</header>
		<div class="pl-6 pt-6">
			<CardPlayButton client:load id={id} size="large" />
		</div>

		<div class="relative z-10 px-6 pt-5"></div>

		<section class="p-6">
			<MusicsTable songs={playListSongs} client:load />
		</section>
	</div>
</Layout>
